<!DOCTYPE HTML>
<html lang=en>
<head>
<meta charset="UTF-8"/>
<title>Alien Invasion</title>
<meta name=viewport content="width=device-width, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0"/>
<style>html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}#bat{display:grid;justify-content:center;align-content:center;min-height:100vh;background-color:black;}#container{padding-top:0;margin:0 auto}#game{height:100vh;justify-content:center;align-content:center;margin:auto;}canvas{background-color:black;}</style>
</head>
<body>
<div id=bat><div id=container>
<canvas id=game width=320 height=480></canvas>
</div></div>
<script>(function(){var b=0;var c=["ms","moz","webkit","o"];for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(h,e){var d=new Date().getTime();var f=Math.max(0,16-(d-b));var g=window.setTimeout(function(){h(d+f)},f);b=d+f;return g}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d)}}}());var Game=new function(){var c=[];this.initialize=function(e,f,g){this.canvas=document.getElementById(e);this.playerOffset=10;this.canvasMultiplier=1;this.setupMobile();this.width=this.canvas.width;this.height=this.canvas.height;this.ctx=this.canvas.getContext&&this.canvas.getContext("2d");if(!this.ctx){return alert("Please upgrade your browser to play")}this.setupInput();this.loop();if(this.mobile){this.setBoard(4,new TouchControls())}SpriteSheet.load(f,g)};var b={37:"left",39:"right",32:"fire"};this.keys={};this.setupInput=function(){window.addEventListener("keydown",function(f){if(b[f.keyCode]){Game.keys[b[f.keyCode]]=true;f.preventDefault()}},false);window.addEventListener("keyup",function(f){if(b[f.keyCode]){Game.keys[b[f.keyCode]]=false;f.preventDefault()}},false)};var d=new Date().getTime();var a=1/30;this.loop=function(){var h=new Date().getTime();requestAnimationFrame(Game.loop);var g=(h-d)/1000;if(g>a){g=a}for(var f=0,e=c.length;f<e;f++){if(c[f]){c[f].step(g);c[f].draw(Game.ctx)}}d=h};this.setBoard=function(e,f){c[e]=f};this.setupMobile=function(){var f=document.getElementById("container"),i=!!("ontouchstart" in window),e=window.innerWidth,g=window.innerHeight;if(i){this.mobile=true}if(screen.width>=1280||!i){return false}if(e>g){alert("Please rotate the device and then click OK");e=window.innerWidth;g=window.innerHeight}f.style.height=g*2+"px";window.scrollTo(0,1);g=window.innerHeight+2;f.style.height=g+"px";f.style.width=e+"px";f.style.padding=0;if(g>=this.canvas.height*1.75||e>=this.canvas.height*1.75){this.canvasMultiplier=2;this.canvas.width=e/2;this.canvas.height=g/2;this.canvas.style.width=e+"px";this.canvas.style.height=g+"px"}else{this.canvas.width=e;this.canvas.height=g}this.canvas.style.position="absolute";this.canvas.style.left="0px";this.canvas.style.top="0px"}};var SpriteSheet=new function(){this.map={};this.load=function(a,b){this.map=a;this.image=new Image();this.image.onload=b;this.image.src="i.png"};this.draw=function(b,c,a,f,e){var d=this.map[c];if(!e){e=0}b.drawImage(this.image,d.sx+e*d.w,d.sy,d.w,d.h,Math.floor(a),Math.floor(f),d.w,d.h)};return this};var TitleScreen=function TitleScreen(c,b,d){var a=false;this.step=function(e){if(!Game.keys.fire){a=true}if(a&&Game.keys.fire&&d){d()}};this.draw=function(e){e.fillStyle="#FFFFFF";e.font="bold 40px bangers";var f=e.measureText(c);e.fillText(c,Game.width/2-f.width/2,Game.height/2);e.font="bold 20px bangers";var g=e.measureText(b);e.fillText(b,Game.width/2-g.width/2,Game.height/2+40)}};var GameBoard=function(){var a=this;this.objects=[];this.cnt={};this.add=function(b){b.board=this;this.objects.push(b);this.cnt[b.type]=(this.cnt[b.type]||0)+1;return b};this.remove=function(c){var b=this.removed.indexOf(c);if(b==-1){this.removed.push(c);return true}else{return false}};this.resetRemoved=function(){this.removed=[]};this.finalizeRemoved=function(){for(var d=0,c=this.removed.length;d<c;d++){var b=this.objects.indexOf(this.removed[d]);if(b!=-1){this.cnt[this.removed[d].type]--;this.objects.splice(b,1)}}};this.iterate=function(f){var c=Array.prototype.slice.call(arguments,1);for(var d=0,b=this.objects.length;d<b;d++){var e=this.objects[d];e[f].apply(e,c)}};this.detect=function(d){for(var c=0,e=null,b=this.objects.length;c<b;c++){if(d.call(this.objects[c])){return this.objects[c]}}return false};this.step=function(b){this.resetRemoved();this.iterate("step",b);this.finalizeRemoved()};this.draw=function(b){this.iterate("draw",b)};this.overlap=function(c,b){return !((c.y+c.h-1<b.y)||(c.y>b.y+b.h-1)||(c.x+c.w-1<b.x)||(c.x>b.x+b.w-1))};this.collide=function(c,b){return this.detect(function(){if(c!=this){var d=(!b||this.type&b)&&a.overlap(c,this);return d?this:false}})}};var Sprite=function(){};Sprite.prototype.setup=function(a,b){this.sprite=a;this.merge(b);this.frame=this.frame||0;this.w=SpriteSheet.map[a].w;this.h=SpriteSheet.map[a].h};Sprite.prototype.merge=function(a){if(a){for(var b in a){this[b]=a[b]}}};Sprite.prototype.draw=function(a){SpriteSheet.draw(a,this.sprite,this.x,this.y,this.frame)};Sprite.prototype.hit=function(a){this.board.remove(this)};var Level=function(b,c){this.levelData=[];for(var a=0;a<b.length;a++){this.levelData.push(Object.create(b[a]))}this.t=0;this.callback=c};Level.prototype.step=function(b){var j=0,f=[],c=null;this.t+=b*1000;while((c=this.levelData[j])&&(c[0]<this.t+2000)){if(this.t>c[1]){f.push(c)}else{if(c[0]<this.t){var d=enemies[c[3]],a=c[4];this.board.add(new Enemy(d,a));c[0]+=c[2]}}j++}for(var e=0,g=f.length;e<g;e++){var h=this.levelData.indexOf(f[e]);if(h!=-1){this.levelData.splice(h,1)}}if(this.levelData.length===0&&this.board.cnt[OBJECT_ENEMY]===0){if(this.callback){this.callback()}}};Level.prototype.draw=function(a){};var TouchControls=function(){var a=10;var b=Game.width/5;var c=b-a;this.drawSquare=function(g,e,i,d,f){g.globalAlpha=f?0.9:0.6;g.fillStyle="#CCC";g.fillRect(e,i,c,c);g.fillStyle="#FFF";g.globalAlpha=1;g.font="bold "+(3*b/4)+"px arial";var h=g.measureText(d);g.fillText(d,e+c/2-h.width/2,i+3*c/4+5)};this.draw=function(d){d.save();var e=Game.height-b;this.drawSquare(d,a,e,"\u25C0",Game.keys.left);this.drawSquare(d,b+a,e,"\u25B6",Game.keys.right);this.drawSquare(d,4*b,e,"A",Game.keys.fire);d.restore()};this.step=function(d){};this.trackTouch=function(g){var h,d;g.preventDefault();Game.keys.left=false;Game.keys.right=false;for(var f=0;f<g.targetTouches.length;f++){h=g.targetTouches[f];d=h.pageX/Game.canvasMultiplier-Game.canvas.offsetLeft;if(d<b){Game.keys.left=true}if(d>b&&d<2*b){Game.keys.right=true}}if(g.type=="touchstart"||g.type=="touchend"){for(f=0;f<g.changedTouches.length;f++){h=g.changedTouches[f];d=h.pageX/Game.canvasMultiplier-Game.canvas.offsetLeft;if(d>4*b){Game.keys.fire=(g.type=="touchstart")}}}};Game.canvas.addEventListener("touchstart",this.trackTouch,true);Game.canvas.addEventListener("touchmove",this.trackTouch,true);Game.canvas.addEventListener("touchend",this.trackTouch,true);Game.canvas.addEventListener("dblclick",function(d){d.preventDefault()},true);Game.canvas.addEventListener("click",function(d){d.preventDefault()},true);Game.playerOffset=b+20};var GamePoints=function(){Game.points=0;var a=8;this.draw=function(c){c.save();c.font="bold 18px arial";c.fillStyle="#FFFFFF";var b=""+Game.points;var e=a-b.length,d="";while(e-->0){d+="0"}c.fillText(d+b,10,20);c.restore()};this.step=function(b){}};</script>
<script type=text/javascript>var sprites={ship:{sx:0,sy:0,w:37,h:42,frames:1},missile:{sx:0,sy:30,w:2,h:10,frames:1},enemy_purple:{sx:37,sy:0,w:42,h:43,frames:1},enemy_bee:{sx:79,sy:0,w:37,h:43,frames:1},enemy_ship:{sx:116,sy:0,w:42,h:43,frames:1},enemy_circle:{sx:158,sy:0,w:32,h:33,frames:1},explosion:{sx:0,sy:64,w:64,h:64,frames:12},enemy_missile:{sx:9,sy:42,w:3,h:20,frame:1}};var enemies={straight:{x:0,y:-50,sprite:"enemy_ship",health:10,E:100},ltr:{x:0,y:-100,sprite:"enemy_purple",health:10,B:75,C:1,E:100,missiles:2},circle:{x:250,y:-50,sprite:"enemy_circle",health:10,A:0,B:-100,C:1,E:20,F:100,G:1,H:Math.PI/2},wiggle:{x:100,y:-50,sprite:"enemy_bee",health:20,B:50,C:4,E:100,firePercentage:0.001,missiles:2},step:{x:0,y:-50,sprite:"enemy_circle",health:10,B:150,C:1.2,E:75}};var OBJECT_PLAYER=1,OBJECT_PLAYER_PROJECTILE=2,OBJECT_ENEMY=4,OBJECT_ENEMY_PROJECTILE=8,OBJECT_POWERUP=16;var startGame=function(){var a=navigator.userAgent.toLowerCase();if(a.match(/android/)){Game.setBoard(0,new Starfield(50,0.6,100,true))}else{Game.setBoard(0,new Starfield(20,0.4,100,true));Game.setBoard(1,new Starfield(50,0.6,100));Game.setBoard(2,new Starfield(100,1,50))}Game.setBoard(3,new TitleScreen("Alien Invasion","Press fire to start playing",playGame))};var level1=[[0,4000,500,"step"],[6000,13000,800,"ltr"],[10000,16000,400,"circle"],[17800,20000,500,"straight",{x:50}],[18200,20000,500,"straight",{x:90}],[18200,20000,500,"straight",{x:10}],[22000,25000,400,"wiggle",{x:150}],[22000,25000,400,"wiggle",{x:100}]];var playGame=function(){var a=new GameBoard();a.add(new PlayerShip());a.add(new Level(level1,winGame));Game.setBoard(3,a);Game.setBoard(5,new GamePoints(0))};var winGame=function(){Game.setBoard(3,new TitleScreen("Bahubali win!","Press fire to play again",playGame))};var loseGame=function(){Game.setBoard(3,new TitleScreen("Bahubali lose!","Press fire to play again",playGame))};var Starfield=function(f,d,c,b){var a=document.createElement("canvas");a.width=Game.width;a.height=Game.height;var h=a.getContext("2d");var g=0;if(b){h.fillStyle="#000";h.fillRect(0,0,a.width,a.height)}h.fillStyle="#FFF";h.globalAlpha=d;for(var e=0;e<c;e++){h.fillRect(Math.floor(Math.random()*a.width),Math.floor(Math.random()*a.height),2,2)}this.draw=function(j){var i=Math.floor(g);var k=a.height-i;if(i>0){j.drawImage(a,0,k,a.width,i,0,0,a.width,i)}if(k>0){j.drawImage(a,0,0,a.width,k,0,i,a.width,k)}};this.step=function(i){g+=i*f;g=g%a.height}};var PlayerShip=function(){this.setup("ship",{vx:0,reloadTime:0.25,maxVel:200});this.reload=this.reloadTime;this.x=Game.width/2-this.w/2;this.y=Game.height-Game.playerOffset-this.h;this.step=function(a){if(Game.keys.left){this.vx=-this.maxVel}else{if(Game.keys.right){this.vx=this.maxVel}else{this.vx=0}}this.x+=this.vx*a;if(this.x<0){this.x=0}else{if(this.x>Game.width-this.w){this.x=Game.width-this.w}}this.reload-=a;if(Game.keys.fire&&this.reload<0){Game.keys.fire=false;this.reload=this.reloadTime;this.board.add(new PlayerMissile(this.x,this.y+this.h/2));this.board.add(new PlayerMissile(this.x+this.w,this.y+this.h/2))}}};PlayerShip.prototype=new Sprite();PlayerShip.prototype.type=OBJECT_PLAYER;PlayerShip.prototype.hit=function(a){if(this.board.remove(this)){loseGame()}};var PlayerMissile=function(a,b){this.setup("missile",{vy:-700,damage:10});this.x=a-this.w/2;this.y=b-this.h};PlayerMissile.prototype=new Sprite();PlayerMissile.prototype.type=OBJECT_PLAYER_PROJECTILE;PlayerMissile.prototype.step=function(a){this.y+=this.vy*a;var b=this.board.collide(this,OBJECT_ENEMY);if(b){b.hit(this.damage);this.board.remove(this)}else{if(this.y<-this.h){this.board.remove(this)}}};var Enemy=function(b,a){this.merge(this.baseParameters);this.setup(b.sprite,b);this.merge(a)};Enemy.prototype=new Sprite();Enemy.prototype.type=OBJECT_ENEMY;Enemy.prototype.baseParameters={A:0,B:0,C:0,D:0,E:0,F:0,G:0,H:0,t:0,reloadTime:0.75,reload:0};Enemy.prototype.step=function(a){this.t+=a;this.vx=this.A+this.B*Math.sin(this.C*this.t+this.D);this.vy=this.E+this.F*Math.sin(this.G*this.t+this.H);this.x+=this.vx*a;this.y+=this.vy*a;var b=this.board.collide(this,OBJECT_PLAYER);if(b){b.hit(this.damage);this.board.remove(this)}if(Math.random()<0.01&&this.reload<=0){this.reload=this.reloadTime;if(this.missiles==2){this.board.add(new EnemyMissile(this.x+this.w-2,this.y+this.h));this.board.add(new EnemyMissile(this.x+2,this.y+this.h))}else{this.board.add(new EnemyMissile(this.x+this.w/2,this.y+this.h))}}this.reload-=a;if(this.y>Game.height||this.x<-this.w||this.x>Game.width){this.board.remove(this)}};Enemy.prototype.hit=function(a){this.health-=a;if(this.health<=0){if(this.board.remove(this)){Game.points+=this.points||100;this.board.add(new Explosion(this.x+this.w/2,this.y+this.h/2))}}};var EnemyMissile=function(a,b){this.setup("enemy_missile",{vy:200,damage:10});this.x=a-this.w/2;this.y=b};EnemyMissile.prototype=new Sprite();EnemyMissile.prototype.type=OBJECT_ENEMY_PROJECTILE;EnemyMissile.prototype.step=function(a){this.y+=this.vy*a;var b=this.board.collide(this,OBJECT_PLAYER);if(b){b.hit(this.damage);this.board.remove(this)}else{if(this.y>Game.height){this.board.remove(this)}}};var elem=document.documentElement;function openFullscreen(){if(elem.requestFullscreen){elem.requestFullscreen()}else{if(elem.webkitRequestFullscreen){elem.webkitRequestFullscreen()}else{if(elem.msRequestFullscreen){elem.msRequestFullscreen()}}}}function closeFullscreen(){if(document.exitFullscreen){document.exitFullscreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}}}}var Explosion=function(b,a){this.setup("explosion",{frame:0});this.x=b-this.w/2;this.y=a-this.h/2};Explosion.prototype=new Sprite();Explosion.prototype.step=function(a){this.frame++;if(this.frame>=12){this.board.remove(this)}};window.addEventListener("load",function(){Game.initialize("game",sprites,startGame)});</script>
</body>
</html>